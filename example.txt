dkek-test.pbe.b64:

U2FsdGVkX19svhSIBSqUH/GixQX4+9KdFKpErNW7MLzNCX9YBE7+eseQB6Vh7Jga
FmhlWzIcqCgB39n9xXe6BA==

$ b64 -d dkek-test.pbe.b64 dkek-test.pbe  



INFO:root:loading DKEK file share @ dkek-test.pbe
INFO:root:salt: b'6CBE1488052A941F'
INFO:root:ciphertext: (L 48) b'F1A2C505F8FBD29D14AA44ACD5BB30BCCD097F58044EFE7AC79007A561EC981A1668655B321CA82801DFD9FDC577BA04'
INFO:root:deriving DKEK share encryption key (step 1 of 3)...
INFO:root:deriving DKEK share encryption key (step 2 of 3)...
INFO:root:deriving DKEK share encryption key (step 3 of 3)...
INFO:root:key_iv [l=48]: b'4037194df2f11b0d0cf5f2bc95acf75316d1edb2daf26ef9224c30afdffac59f67e6449f70f8af424408ead85e3a4a36'
INFO:root:key: b'4037194DF2F11B0D0CF5F2BC95ACF75316D1EDB2DAF26EF9224C30AFDFFAC59F'
INFO:root:iv: b'67E6449F70F8AF424408EAD85E3A4A36'
INFO:root:recovered DKEK: b'C955AF6FB058CA963D270049DE57B75B175D528B8993D7651DCC4650097CAFFB'
INFO:root:KCV for recovered key: b'8C413C'

Using reader with a card: Nitrokey Nitrokey HSM (DENK01057020000         ) 00 00
Enter password to decrypt DKEK share : 

Deciphering DKEK share, please wait...
DKEK share imported
DKEK shares          : 1
DKEK key check value : 2AFA121E8764A1E3

$ pkcs11-tool --login --pin f0365bf44b657ba --keypairgen --key-type EC:secp256k1 --label btc-test

	Using slot 0 with a present token (0x0)
	Key pair generated:
	Private Key Object; EC
	label:      btc-test
	ID:         4d8b45c6b9e00aee9c677b595e7b7b72572035ed
	Usage:      sign, derive
	Access:     none
	Public Key Object; EC  EC_POINT 256 bits
	EC_POINT:   044104a19764d69d2aeada6b3766b7109b26285f478f7116d19c2558bd3a6cb46b62047d2cb0c1d4f7b7c1140744cf5b0410701f4bde469d5e7785a57555f6eeedd84c
	EC_PARAMS:  06052b8104000a
	label:      btc-test
	ID:         4d8b45c6b9e00aee9c677b595e7b7b72572035ed
	Usage:      verify, derive
	Access:     none

pkcs15-tool --dump

export:

sc-hsm-tool --wrap-key wrapped-btc-key.bin --key-reference 1 --pin f0365bf44b657ba

import:

sc-hsm-tool --unwrap-key wrap-key-1.bin --key-reference 1 --pin 648219


SEQUENCE (3 elem)
  OCTET STRING (363 byte) 97E303855DC1C54D0C000A04007F00070202020203000000000000B2C97ABAF6BF457…
  [0] (3 elem)
    SEQUENCE (3 elem)
        Offset: 373
        Length: 2+17
        (constructed)
        Value:
        (3 elem)
      UTF8String btc-test
      BIT STRING (2 bit) 11
      OCTET STRING (1 byte) 01
    SEQUENCE (3 elem)
      OCTET STRING (20 byte) 4D8B45C6B9E00AEE9C677B595E7B7B72572035ED
      BIT STRING (9 bit) 001100001
      INTEGER 1
    [1] (1 elem)
      SEQUENCE (2 elem)
        SEQUENCE (1 elem)
          OCTET STRING (0 byte)
        INTEGER 256 <--- size im bits
  Application 7 (3 elem)
    Application 33 (2 elem)
      Application 78 (4 elem)
        Application 41 (1 byte) 00
        Application 2 (9 byte) UTCA00001
        Application 73 (8 elem)
          OBJECT IDENTIFIER 0.4.0.127.0.7.2.2.2.2.3 bsiTA_ECDSA_SHA256 (BSI TR-03110)
          [1] (32 byte) FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F
          [2] (32 byte) 0000000000000000000000000000000000000000000000000000000000000000
          [3] (32 byte) 0000000000000000000000000000000000000000000000000000000000000007
          [4] (65 byte) 0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483A…
          [5] (32 byte) FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141
          [6] (65 byte) 04A19764D69D2AEADA6B3766B7109B26285F478F7116D19C2558BD3A6CB46B62047D2C…
          [7] (1 byte) 01
        Application 32 (16 byte) DENK010570200001
      Application 55 (64 byte) 5A57749F2AC57FE38C18820572AF7FC17093ABA758529724ED20C960C8D5A3136976D0…
    Application 2 (16 byte) DENK010570200000
    Application 55 (64 byte) 1F5F4E5192E0EC51D41F677A672CE2502AA01CC785A285CE354D1F529136A6C7130DCF…