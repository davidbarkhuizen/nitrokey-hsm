import unittest
from binascii import unhexlify

from core.dkek import decrypt_wrapped_key_blob

dkek = unhexlify('2848cb6e994f5a00c365c3c255ed130512ce1eb06bf08d348eeb8b2f866e3e50')
wrapped_btc_key = unhexlify('3082039a0482016b97e303855dc1c54d0c000a04007f000702020202030000000000000406f4d461aae8e7e75db2b320077d4f202fda4edd7609e8e0a0df754258ea7e9398587cd682a509c3a343c772a75196ff33aac1f0ac4ce4a1d06c0198c20ffe197880c256729bff05619bd39dc37af5ffd1da0a726f020664e60a9c42114202084010bfb3170e49e1fa214ff13a4aaeebf1b5596b5b5bbfca9cc228a88eed3a5de7aad8d33212e30b12333656746bc65392ac3d42b91b684d907fdb871d3aa40f27a3dadbbd08824f915680e33adf9c004d8e6d0365dd66a941dd388d127838ff29b20659642e88622527f4bfd4ddade2f7c70b92834fcd015a5474eda9c6b2c2cdbb6412cde10e9325a6bd2d3a0171d0f90a350bee2fdcf614694dc5d8d8661f8fb95919637606fde7c94fb01d1aee95fd89e46a210d4abec0ba90c1ec2330d725914d62f469867ed1d20add91158af49d29515ae34dd9c665f3e1285a23e345edb875a38ba94f3306d3c8e4854142a03f30110c086274632d74657374030206c0040101301e0414272bc2fea76fd825cf980751a58de8191ff7f0940303073080020101a10a30083002040002020100678201e67f2182018c7f4e8201445f29010042095554434130303030317f4982011d060a04007f000702020202038120fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f822000000000000000000000000000000000000000000000000000000000000000008320000000000000000000000000000000000000000000000000000000000000000784410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b88520fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141864104492387dbacdf9abde5f56afee0b2e762a3548c0201ca46c5c0bc4a610cd7f78c87fea9e9c70e6085bd163102835aeb84db80daa3b31cc7a6c1bcf4d9b32a236f8701015f201044454e4b3031303537303230303030315f37405d7ddda0b78f1f836cbf03f3263c64a91cfaa354562ad8b2849cb15940985e8152f830919483ac26943e965f057cb1860b7f5fbbf41882693af0fd412e2c2752421044454e4b3031303537303230303030305f37406004124050d3a530092347a14c0f11aff207c5bd9b79cb45ed4e3890fbfa3ca35bf6f799609ee146e1304b61e803957b2fe3f24771ae94c19d64a1f1c71fb69b')

class TestKeyWrapping(unittest.TestCase):
    
    def test_encryption_of_wrapped_btc_key(self):
        decrypt_wrapped_key_blob(dkek, wrapped_btc_key)
        self.assertEqual(True, True)

if __name__ == '__main__':
    unittest.main()