import unittest
from binascii import unhexlify

from core.dkek import decrypt_wrapped_key_blob

dkek = unhexlify('2848cb6e994f5a00c365c3c255ed130512ce1eb06bf08d348eeb8b2f866e3e50')
wrapped_btc_key = unhexlify('3082039a0482016b97e303855dc1c54d0c000a04007f00070202020203000000000000b2c97abaf6bf457fd94d5d76eb668dd10d042b3aebacc4f5b36f723e1ca129c0b6676f2b63ba6accf71923b6bd8d2c3a9190e19722c763c3082c35605caaa4d2c2eef72b42c5b5040da7f9a7a5450d33f49722137f479f9f34bf8d79d08ff109c756edb3c1ff77b5b2edc548da72629708bc618f5c262591420d45c5decb6cc5cd4aef328c8320aa90aa1f755f0aaee27af363cc5db5d21d912570866884c491c51325df73194bb641fd74080e49559a3a11a96c29eccddbf8dcad16352588a8b58990adf360df03e0e9d6081772d89a33b38931c64ebf4f9c8a3aa10fc87d71525a299401739531c0856b694bc124b2df87183bec684824bf57dba60ca511f3be96fcf16c06a4c4ad9c5c844d04d0f3d8a95208ea818d92263d1b754b0a840bd41b8d12f328b891f7bbad8f84806f5cfc24faa7b38b369fb98efdb77bccfb5af27e6021516b79619479e6138663277da03f30110c086274632d74657374030206c0040101301e04144d8b45c6b9e00aee9c677b595e7b7b72572035ed0303073080020101a10a30083002040002020100678201e67f2182018c7f4e8201445f29010042095554434130303030317f4982011d060a04007f000702020202038120fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f822000000000000000000000000000000000000000000000000000000000000000008320000000000000000000000000000000000000000000000000000000000000000784410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b88520fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141864104a19764d69d2aeada6b3766b7109b26285f478f7116d19c2558bd3a6cb46b62047d2cb0c1d4f7b7c1140744cf5b0410701f4bde469d5e7785a57555f6eeedd84c8701015f201044454e4b3031303537303230303030315f37405a57749f2ac57fe38c18820572af7fc17093aba758529724ed20c960c8d5a3136976d077434904d12192f64b30dcf5d65610c8d879f1f9c23cedbcfe105bddb3421044454e4b3031303537303230303030305f37401f5f4e5192e0ec51d41f677a672ce2502aa01cc785a285ce354d1f529136a6c7130dcf81d62d300884c15ea489cec955617c8ef00c1665cbc102bb788ae7de90')

class TestKeyWrapping(unittest.TestCase):
    
    def test_encryption_of_wrapped_btc_key(self):
        print()
        print()
        decrypt_wrapped_key_blob(dkek, wrapped_btc_key)
        self.assertEqual(True, True)

if __name__ == '__main__':
    unittest.main()